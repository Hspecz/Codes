//=====================
// 
// Adding Custom Race - Transcendence (Riggo)
// 
//=====================
rAthena Source Mod: New Race "Transcendence"

This modification adds a completely new race RC_TRANSCENDENCE to the server.
Entities of this race will automatically have:

+40% Damage against all non-Transcendence targets.

+30% Resistance to damage from all sources.

1. Define the New Race ID

File: src/map/status.hpp

Find: (Look for the enum e_race)

	RC_DEMIHUMAN,
	RC_ANGEL,
	RC_DRAGON,
	RC_BOSS,
	RC_NONBOSS,
	RC_ALL,
	RC_MAX,


Add BEFORE RC_BOSS or RC_MAX:
Note: It is safer to add it before RC_BOSS or specific special constants to avoid shifting standard race IDs if possible, but adding it before RC_MAX is the standard way for new custom races.

	RC_TRANSCENDENCE, // Custom Race


2. Implement Battle Properties

We need to check for this race during damage calculation and apply the modifiers.

File: src/map/battle.cpp

Find: battle_calc_damage function.
Find: The section where cardfix is calculated (Search for battle_calc_cardfix).

Add BELOW battle_calc_cardfix(...):

	// --- Custom Race: Transcendence Logic ---
	
	// 1. Offensive Bonus: If Attacker is Transcendence, deal +40% damage to others
	if (battle_check_target(src, bl, BCT_ENEMY) && status_get_race(src) == RC_TRANSCENDENCE) {
		if (status_get_race(bl) != RC_TRANSCENDENCE) { // Optional: Don't deal bonus dmg to own race
			damage += damage * 40 / 100;
		}
	}

	// 2. Defensive Bonus: If Defender is Transcendence, resist 30% from all sources
	if (status_get_race(bl) == RC_TRANSCENDENCE) {
		damage -= damage * 30 / 100;
	}
	
	// ----------------------------------------


Note: We place this after card fixes but before final result clamping to ensure it acts as a final multiplier.

3. Register for Scripting

To allow you to turn players into this race using items, we need to register the constant.

File: src/map/script_constants.hpp

Find: RC_DEMIHUMAN
Add Below:

	export_constant(RC_TRANSCENDENCE);


4. Database Update

File: db/re/const.txt (and db/pre-re/const.txt)

Add at the end:

RC_Transcendence	(Next Available ID Number)


Important: You must check src/map/status.hpp to see what integer value RC_TRANSCENDENCE actually got assigned (by counting the enums or hovering over it in an IDE) and put that number here. Usually, if RC_DRAGON is 9, this might be 10 or 11.

5. How to Use

To make a player "Transcend" (change their race to this new one), create an item (like a "God Ring") with the following script:

// Changes the wearer's race to Transcendence
{ bonus bRace, RC_Transcendence; }


Once equipped:

getrace(RC_Transcendence) checks will return true.

Hydra Cards (Anti-DemiHuman) will no longer work on this player (because they are no longer Demi-Human).

They will deal 40% more damage to everyone.

They will take 30% less damage from everyone.
